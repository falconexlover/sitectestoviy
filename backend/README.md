# Бэкенд для сайта "Лесной дворик"

Этот проект представляет собой бэкенд-сервер для сайта "Лесной дворик", обеспечивающий функциональность административной панели и API для работы фронтенда.

## Структура проекта

```
backend/
├── src/
│   ├── controllers/   # Контроллеры API
│   ├── middleware/    # Промежуточное ПО (middleware)
│   ├── models/        # Модели MongoDB
│   ├── routes/        # Маршруты API
│   └── server.js      # Основной файл сервера
├── uploads/           # Директория для загруженных файлов
├── .env               # Переменные окружения
├── package.json       # Зависимости проекта
├── docker-compose.yml # Конфигурация Docker Compose
└── Dockerfile         # Dockerfile
```

## Требования

- Node.js 18+
- MongoDB 6+
- или Docker и Docker Compose для контейнеризации

## Установка и запуск

### Вариант 1: Локальная установка

1. Клонировать репозиторий:
   ```
   git clone <url-репозитория>
   cd backend
   ```

2. Установить зависимости:
   ```
   npm install
   ```

3. Создать файл `.env` в корне проекта со следующими переменными:
   ```
   PORT=5000
   MONGODB_URI=mongodb://localhost:27017/hotel_forest
   JWT_SECRET=ваш_секретный_ключ_jwt
   JWT_EXPIRES_IN=24h
   ADMIN_USERNAME=admin
   ADMIN_PASSWORD=ваш_надежный_пароль
   NODE_ENV=development
   ```

4. Запустить сервер:
   ```
   npm run dev    # для разработки
   npm start      # для продакшена
   ```

### Вариант 2: Использование Docker Compose

1. Клонировать репозиторий:
   ```
   git clone <url-репозитория>
   cd backend
   ```

2. Настроить переменные окружения в `docker-compose.yml`:
   - Изменить `JWT_SECRET` на уникальное значение
   - Изменить `ADMIN_USERNAME` и `ADMIN_PASSWORD` на более безопасные

3. Запустить с помощью Docker Compose:
   ```
   docker-compose up -d
   ```

4. Проверить, что сервисы запустились:
   ```
   docker-compose ps
   ```

## Развертывание на сервере

### Настройка на VPS

1. Настройте сервер с доступом по SSH
2. Установите Docker и Docker Compose на сервер
3. Клонируйте репозиторий:
   ```
   git clone <url-репозитория>
   cd backend
   ```
4. Настройте переменные в `docker-compose.yml`:
   - Изменить `JWT_SECRET` на уникальное значение
   - Изменить `ADMIN_USERNAME` и `ADMIN_PASSWORD` на более безопасные

5. Запустите с помощью Docker Compose:
   ```
   docker-compose up -d
   ```

### Настройка фронтенда

Для корректной работы с фронтендом, размещенным на Vercel, необходимо:

1. Настроить CORS на бэкенде, чтобы разрешить запросы с домена Vercel. Это уже настроено по умолчанию.

2. Обновить переменную окружения в проекте фронтенда на Vercel:
   - `REACT_APP_API_URL` = URL вашего бэкенд-сервера (например, https://api.yourdomain.com)

## API-эндпоинты

### Аутентификация

- `POST /api/auth/login` - Вход в систему администратора
- `GET /api/auth/check` - Проверка статуса аутентификации

### Галерея

- `GET /api/gallery` - Получить все изображения
- `GET /api/gallery/:id` - Получить изображение по ID
- `POST /api/gallery` - Загрузить новое изображение (требуется авторизация)
- `PUT /api/gallery/:id` - Обновить информацию об изображении (требуется авторизация)
- `DELETE /api/gallery/:id` - Удалить изображение (требуется авторизация)

### Номера

- `GET /api/rooms` - Получить все номера
- `GET /api/rooms/:id` - Получить номер по ID
- `POST /api/rooms` - Создать новый номер (требуется авторизация)
- `PUT /api/rooms/:id` - Обновить номер (требуется авторизация)
- `DELETE /api/rooms/:id` - Удалить номер (требуется авторизация)

### Главная страница

- `GET /api/homepage` - Получить данные главной страницы
- `PUT /api/homepage/section/:section` - Обновить секцию (требуется авторизация)
- `POST /api/homepage/image` - Загрузить изображение для секции (требуется авторизация)

## Безопасность

- Для всех административных операций требуется JWT-токен
- Пароли для администратора хранятся в переменных окружения
- Используется HTTPS для защиты соединения (настраивается на уровне reverse proxy)

## Дополнительная информация

Для поддержки бэкенда и управления контентом:

1. Войдите в режим администратора на сайте
2. Используйте административную панель для управления контентом
 